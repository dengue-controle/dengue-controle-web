<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle Dengue - Lista de Atividades</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/common.css">
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
	<link rel="icon" href="favicon.ico" type="image/x-icon">
	<style>
		/* TABLE DIV */

		.div-table{
			display: table;
			width: 100%;
		}
		.div-table-row {
			display: table-row;
		}
		.div-table-heading {
			display: table-header-group;
		}
		.div-table-cell, .div-table-head {
			display: table-cell;
			padding: 3px 10px;
		}

		.div-table-heading {
			display: table-header-group;
			font-weight: bold;
		}
		.div-table-foot {
			display: table-footer-group;
			font-weight: bold;
		}
		.div-table-body {
			display: table-row-group;
		}

		/* TABLES */

		.table {
			border-top: 1px solid #DFDFDF;
			border-collapse: collapse;
			width: 100%;
		}

		.table tr {
			border: 0;
		}

		.table tr>td:first-child, .table tr>th:first-child {
			padding-left: 1.25em;
		}

		.table tr>td:last-child, .table tr>th:last-child {
			padding-right: 1.25em;
		}

		.table td, .table th {
			line-height: 1.5em;
			padding: 0.5em 0.6em;
			text-align: left;
		}

		.table td.text-center, .table th.text-center {
			text-align: center;
		}

		.table th {
			background-color: #efefef;
			background-image: -moz-linear-gradient(top, #ffffff, #eaeaea);
			background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #ffffff), color-stop(1, #eaeaea));
				filter: progid:DXImageTransform.Microsoft.gradient(startColorStr = '#ffffff', EndColorStr = '#eaeaea');
			-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorStr='#ffffff', EndColorStr='#eaeaea')";
			color: #666666;
			font-weight: bold;
			line-height: 1.7em;
			padding: 0.2em 0.6em;
		}

		.table thead th {
			white-space: nowrap;
		}

		.table th a {
			display: block;
			text-decoration: none;
		}

		.table th a:link, th a:visited {
			color: #666666;
		}

		.table th a:hover, th a:focus {
			color: #333333;
		}

		.table th.sortable a {
			background-position: right;
			background-repeat: no-repeat;
			padding-right: 1.1em;
			background-image: url(../images/skin/sortable.gif);
		}

		.table th.asc a {
			background-image: url(../images/skin/sorted_asc.gif);
		}

		.table th.desc a {
			background-image: url(../images/skin/sorted_desc.gif);
		}

		.table tr.double-column td {
			width: 48%;
			text-align: center;
		}

		.table td.column-small {
			width: 10%
		}
		
		.odd {
			background: #f7f7f7;
		}

		.even {
			background: #ffffff;
		}
		
		.table th:hover, .table tr:hover {
			background: #1267671a;
		}
		
		.table th.col-modulo {
			white-space: normal;
			text-align: center;
			font-weight: bold;
			display: block;
		}
		
		.table th.col-modulo-mobile {
			display: none;
		}
		
		.button-action {
			margin-top: 1em;
			color: #666666;
			background-color: #098a4b;
			padding: .3em .7em;
			outline: none;
			cursor: pointer;
		}

		.button-action:hover {
			background-color: #056839;
		}
		
		.button-light{
			background-color: #efefef;
			border-color: #eaeaea;
		}

		.button-light:hover{
			background-color: #eaeaea;
		}

		.button-light i {
			color: #116666;
			padding-right: 0.1em;
		}
		
		.fa-search-plus {
			color: #116666;
		}

		/* --- RESPONSIVE RULES (mobile) --- */
		@media (max-width: 768px) {	

			/* esconder colunas que NÃO devem aparecer no celular */
			.table th.col-id,
			.table td.col-id,
			.table th.col-data,
			.table td.col-data,
			.table th.col-agente,
			.table td.col-agente {
				display: none !important;
			}

			/* reduzir padding / fonte para caber mais conteúdo */
			table.table-responsive {
				font-size: 13px;
			}
			.table th, .table td {
				padding: 0.35em 0.4em;
				white-space: normal;
				word-break: break-word;
			}

			.table th.col-modulo-mobile {
				white-space: normal;
				text-align: center;
				display: block;
			}
			
			.table th.col-modulo {
				display: none;
			}

			/* tornar a coluna de endereço mais compacta */
			.table td.col-endereco {
				max-width: 36ch;
				overflow: hidden;
				overflow-wrap: break-word;
			}

			/* alinha o conteúdo restante de forma clara */
			.table td.col-modulo {
				text-align: center;
			}
		}

		/* Em telas maiores, garantir que a coluna ação esteja centralizada */
		.table td.col-acao { text-align: center; }
    </style>
</head>
<body>

<div id="header-placeholder"></div>

<div id="conteudo">

    <div class="conteudo-titulo">
        <h1>Lista de Atividades</h1>
    </div>

    <div id="list-vistorias" class="conteudo-corpo" role="main">

        <button type="button" class="button-action button-light mbl" style="margin: .8em;" onclick="alert('Filtros em construção')">
            <i class="fa fa-filter"></i> Filtros
        </button>

        <table class="table table-responsive">
            <thead>
                <tr>
                    <th class="col-id">ID</th>
                    <th class="col-endereco">Endereço</th>
                    <th class="col-modulo">
                        Módulo/Quadra/Lote
                    </th>
                    <th class="col-modulo-mobile">
                        <span class="line1">Módulo,</span>
                        <span class="line2">Quadra, Lote</span>
                    </th>
                    <th class="col-data">Data Vistoria</th>
                    <th class="col-agente">Agente</th>
                    <th class="col-atividade">Atividade</th>
                    <th class="col-larvas">Larvas</th>
                    <th class="col-acao"></th>
                </tr>
            </thead>
            <tbody id="tabela-vistorias"></tbody>
        </table>

        <button type="button" onclick="exportarExcel()" class="button-action button-light" style="margin: .8em;">
            <i class="fa fa-file-excel"></i> Exportar Excel
        </button>

    </div>
</div>

<script src="js/header.js"></script>

<script>

    let dadosFicticios;
	
	const tabela = document.getElementById("tabela-vistorias");
	
	(async function() { 
		await carregarDadosJSON();
		
		// Remove conteúdo anterior (caso re-render)
		tabela.innerHTML = '';

		dadosFicticios.forEach((item, idx) => {
			const tr = document.createElement("tr");
			tr.className = idx % 2 === 0 ? "even" : "odd";
			
			const hrefVisualizacao = "visualizacao.html?id=" + item.id;

			const endereco = `${item.logradouro}, ${item.numero} ${item.condominio ? '- ' + item.condominio : ''}`;
			// cada td possui uma classe específica para controle via CSS responsivo
			tr.innerHTML = `
				<td class="col-id">${item.id}</td>
				<td class="col-endereco">${endereco}</td>
				<td class="col-modulo">${item.modulo}/${item.quadra}/${item.lote}</td>
				<td class="col-data">${item.dataVistoria}</td>
				<td class="col-agente">${item.agente}</td>
				<td class="col-atividade">${item.status}</td>
				<td class="col-larvas">${item.larvas || '-'}</td>
				<td class="col-acao text-center">
					<a href="${hrefVisualizacao}">
						<i class="fa fa-lg fa-search-plus faa-pulse animated-hover" title="Visualizar"></i>
					</a>
				</td>
			`;
			tabela.appendChild(tr);
		});
	})();

    function exportarExcel() {
        alert("Exportar Excel ainda não implementado.");
    }
	
	async function carregarDadosJSON() {
		try {
			const response = await fetch('dados.json');
			dadosFicticios = await response.json();
		} catch (error) {
			console.error('Erro ao carregar dados.json:', error);
			alert('Erro ao carregar dados');
			dadosFicticios = [];
		}
	}
</script>

</body>
</html>